{"version":3,"sources":["../../src/lib/cell-ref.js"],"names":["CellRefRecord","tabId","rowIdx","colIdx","CellRef","index","get","tab","ref","row","col"],"mappings":";;;;;;;;;;AAAA;;AACA;;;;;;;;AAEA,IAAMA,gBAAgB,uBAAO;AAC3BC,SAAO,IADoB;AAE3BC,UAAQ,IAFmB;AAG3BC,UAAQ;AAHmB,CAAP,CAAtB;;IAMqBC,O;;;;;;;;;;;8BAiCT;AACR,aAAO,+BACL,EAAEC,OAAO,KAAKC,GAAL,CAAS,QAAT,CAAT,EADK,EAEL,EAAED,OAAO,KAAKC,GAAL,CAAS,QAAT,CAAT,EAFK,EAGL,KAAKA,GAAL,CAAS,OAAT,CAHK,CAAP;AAKD;;;oCAtCsBC,G,EAAKC,G,EAAK;AAAA,0BACZ,oCAAaA,GAAb,CADY;AAAA;AAAA,UACxBC,GADwB;AAAA,UACnBC,GADmB;;AAE/B,UAAMR,SAASO,IAAIJ,KAAnB;AACA,UAAMF,SAASO,IAAIL,KAAnB;;AAEA,aAAO,IAAID,OAAJ,CAAY;AACjBF,sBADiB;AAEjBC,sBAFiB;AAGjBF,eAAOM,IAAID,GAAJ,CAAQ,IAAR;AAHU,OAAZ,CAAP;AAKD;;;8BAEgBE,G,EAAK;AAAA,2BACM,oCAAaA,GAAb,CADN;AAAA;AAAA,UACbC,GADa;AAAA,UACRC,GADQ;AAAA,UACHT,KADG;;AAEpB,UAAMC,SAASO,IAAIJ,KAAnB;AACA,UAAMF,SAASO,IAAIL,KAAnB;;AAEA,aAAO,IAAID,OAAJ,CAAY;AACjBF,sBADiB;AAEjBC,sBAFiB;AAGjBF;AAHiB,OAAZ,CAAP;AAKD;;;uBAESM,G,EAAKL,M,EAAQC,M,EAAQ;AAC7B,aAAO,IAAIC,OAAJ,CAAY;AACjBH,eAAOM,IAAID,GAAJ,CAAQ,IAAR,CADU;AAEjBJ,sBAFiB;AAGjBC;AAHiB,OAAZ,CAAP;AAKD;;;;EA/BkCH,a;;kBAAhBI,O","file":"cell-ref.js","sourcesContent":["import { Record } from 'immutable';\nimport { extractLabel, toLabel } from 'hot-formula-parser';\n\nconst CellRefRecord = Record({\n  tabId: null,\n  rowIdx: null,\n  colIdx: null\n});\n\nexport default class CellRef extends CellRefRecord {\n  static fromTabAndA1Ref(tab, ref) {\n    const [row, col] = extractLabel(ref);\n    const rowIdx = row.index;\n    const colIdx = col.index;\n\n    return new CellRef({\n      rowIdx,\n      colIdx,\n      tabId: tab.get('id')\n    });\n  }\n\n  static fromA1Ref(ref) {\n    const [row, col, tabId] = extractLabel(ref);\n    const rowIdx = row.index;\n    const colIdx = col.index;\n\n    return new CellRef({\n      rowIdx,\n      colIdx,\n      tabId\n    });\n  }\n\n  static of(tab, rowIdx, colIdx) {\n    return new CellRef({\n      tabId: tab.get('id'),\n      rowIdx,\n      colIdx\n    });\n  }\n\n  toA1Ref() {\n    return toLabel(\n      { index: this.get('rowIdx') },\n      { index: this.get('colIdx') },\n      this.get('tabId')\n    );\n  }\n}\n"]}