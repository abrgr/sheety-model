{"version":3,"sources":["../../src/lib/cell-ref-range.js"],"names":["CellRefRangeRecord","start","end","coercer","bind","CellRefRange","params","xform","get","tab","startRow","endRow","startCol","endCol","vals","rowIdx","push","colIdx","merge","of","ref","lastColonIdx","lastIndexOf","from","slice","to","fromA1Ref","set"],"mappings":";;;;;;;;AAAA;;AACA;;;;AACA;;;;;;;;;;;;AAEA,IAAMA,qBAAqB,uBAAO;AAChCC,SAAO,IADyB;AAEhCC,OAAK;AAF2B,CAAP,CAA3B;;AAKA,IAAMC,UAAU,iBAAOC,IAAP,CAAY,IAAZ,EAAkB,mBAAQ;AACxCH,SAAO,eAACA,MAAD;AAAA,WAAW,sBAAYA,MAAZ,CAAX;AAAA,GADiC;AAExCC,OAAK,aAACA,IAAD;AAAA,WAAS,sBAAYA,IAAZ,CAAT;AAAA;AAFmC,CAAR,CAAlB,CAAhB;;IAKqBG,Y;;;AACnB,wBAAYC,MAAZ,EAAoB;AAAA;;AAAA,uHACZH,QAAQG,MAAR,CADY;AAEnB;;;;gCAyBWC,K,EAAO;AACjB,UAAMN,QAAQ,KAAKO,GAAL,CAAS,OAAT,CAAd;AACA,UAAMN,MAAM,KAAKM,GAAL,CAAS,KAAT,CAAZ;AACA,UAAMC,MAAMR,MAAMO,GAAN,CAAU,OAAV,CAAZ;AACA,UAAME,WAAWT,MAAMO,GAAN,CAAU,QAAV,CAAjB;AACA,UAAMG,SAAST,IAAIM,GAAJ,CAAQ,QAAR,CAAf;AACA,UAAMI,WAAWX,MAAMO,GAAN,CAAU,QAAV,CAAjB;AACA,UAAMK,SAASX,IAAIM,GAAJ,CAAQ,QAAR,CAAf;;AAEA,UAAMM,OAAO,EAAb;AACA,WAAM,IAAIC,SAASL,QAAnB,EAA6BK,UAAUJ,MAAvC,EAA+C,EAAEI,MAAjD,EAA0D;AACxDD,aAAKE,IAAL,CAAU,EAAV;AACA,aAAM,IAAIC,SAASL,QAAnB,EAA6BK,UAAUJ,MAAvC,EAA+C,EAAEI,MAAjD,EAA0D;AACxDH,eAAKC,SAASL,QAAd,EAAwBO,SAASL,QAAjC,IAA6CL,MAAMN,MAAMiB,KAAN,CAAY,EAAEH,cAAF,EAAUE,cAAV,EAAZ,CAAN,CAA7C;AACD;AACF;;AAED,aAAOH,IAAP;AACD;;;uBAzCSL,G,EAAKC,Q,EAAUE,Q,EAAUD,M,EAAQE,M,EAAQ;AACjD,aAAO,IAAIR,YAAJ,CAAiB;AACtBJ,eAAO,kBAAQkB,EAAR,CAAWV,GAAX,EAAgBC,QAAhB,EAA0BE,QAA1B,CADe;AAEtBV,aAAK,kBAAQiB,EAAR,CAAWV,GAAX,EAAgBE,MAAhB,EAAwBE,MAAxB;AAFiB,OAAjB,CAAP;AAID;;;8BAEgBO,G,EAAK;AACpB;AACA;AACA,UAAMC,eAAeD,IAAIE,WAAJ,CAAgB,GAAhB,CAArB;AACA,UAAMC,OAAOH,IAAII,KAAJ,CAAU,CAAV,EAAaH,YAAb,CAAb;AACA,UAAMI,KAAKL,IAAII,KAAJ,CAAUH,eAAe,CAAzB,CAAX;;AAEA,UAAMpB,QAAQ,kBAAQyB,SAAR,CAAkBH,IAAlB,CAAd;AACA,UAAMrB,MAAM,kBAAQwB,SAAR,CAAkBD,EAAlB,EAAsBE,GAAtB,CAA0B,OAA1B,EAAmC1B,MAAMO,GAAN,CAAU,OAAV,CAAnC,CAAZ;;AAEA,aAAO,IAAIH,YAAJ,CAAiB;AACtBJ,oBADsB;AAEtBC;AAFsB,OAAjB,CAAP;AAID;;;;EA1BuCF,kB;;kBAArBK,Y","file":"cell-ref-range.js","sourcesContent":["import { Map, Record } from 'immutable';\nimport CellRef from './cell-ref';\nimport coerce from './coerce';\n\nconst CellRefRangeRecord = Record({\n  start: null,\n  end: null\n});\n\nconst coercer = coerce.bind(null, new Map({\n  start: (start) => new CellRef(start),\n  end: (end) => new CellRef(end)\n}));\n\nexport default class CellRefRange extends CellRefRangeRecord {\n  constructor(params) {\n    super(coercer(params));\n  }\n\n  static of(tab, startRow, startCol, endRow, endCol) {\n    return new CellRefRange({\n      start: CellRef.of(tab, startRow, startCol),\n      end: CellRef.of(tab, endRow, endCol)\n    });\n  }\n\n  static fromA1Ref(ref) {\n    // the structure of a ref is <tab><from ref>:<to ref>\n    // <tab> may include a colon so the final colon must be the separator\n    const lastColonIdx = ref.lastIndexOf(':');\n    const from = ref.slice(0, lastColonIdx);\n    const to = ref.slice(lastColonIdx + 1);\n\n    const start = CellRef.fromA1Ref(from);\n    const end = CellRef.fromA1Ref(to).set('tabId', start.get('tabId'));\n\n    return new CellRefRange({\n      start,\n      end\n    });\n  }\n\n  mapCellRefs(xform) {\n    const start = this.get('start');\n    const end = this.get('end');\n    const tab = start.get('tabId');\n    const startRow = start.get('rowIdx');\n    const endRow = end.get('rowIdx');\n    const startCol = start.get('colIdx');\n    const endCol = end.get('colIdx');\n\n    const vals = [];\n    for ( let rowIdx = startRow; rowIdx <= endRow; ++rowIdx ) {\n      vals.push([]);\n      for ( let colIdx = startCol; colIdx <= endCol; ++colIdx ) {\n        vals[rowIdx - startRow][colIdx - startCol] = xform(start.merge({ rowIdx, colIdx }));\n      }\n    }\n\n    return vals;\n  }\n}\n"]}