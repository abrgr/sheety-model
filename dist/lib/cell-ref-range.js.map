{"version":3,"sources":["../../src/lib/cell-ref-range.js"],"names":["CellRefRangeRecord","start","end","coercer","bind","CellRefRange","params","tab","startRow","startCol","endRow","endCol","of","ref","lastColonIdx","lastIndexOf","from","slice","to","fromA1Ref","set","get"],"mappings":";;;;;;;;AAAA;;AACA;;;;AACA;;;;;;;;;;;;AAEA,IAAMA,qBAAqB,uBAAO;AAChCC,SAAO,IADyB;AAEhCC,OAAK;AAF2B,CAAP,CAA3B;;AAKA,IAAMC,UAAU,iBAAOC,IAAP,CAAY,IAAZ,EAAkB,mBAAQ;AACxCH,SAAO,eAACA,MAAD;AAAA,WAAW,sBAAYA,MAAZ,CAAX;AAAA,GADiC;AAExCC,OAAK,aAACA,IAAD;AAAA,WAAS,sBAAYA,IAAZ,CAAT;AAAA;AAFmC,CAAR,CAAlB,CAAhB;;IAKqBG,Y;;;AACnB,wBAAYC,MAAZ,EAAoB;AAAA;;AAAA,uHACZH,QAAQG,MAAR,CADY;AAEnB;;;;uBAESC,G,EAAKC,Q,EAAUC,Q,EAAUC,M,EAAQC,M,EAAQ;AACjD,aAAO,IAAIN,YAAJ,CAAiB;AACtBJ,eAAO,kBAAQW,EAAR,CAAWL,GAAX,EAAgBC,QAAhB,EAA0BC,QAA1B,CADe;AAEtBP,aAAK,kBAAQU,EAAR,CAAWL,GAAX,EAAgBG,MAAhB,EAAwBC,MAAxB;AAFiB,OAAjB,CAAP;AAID;;;8BAEgBE,G,EAAK;AACpB;AACA;AACA,UAAMC,eAAeD,IAAIE,WAAJ,CAAgB,GAAhB,CAArB;AACA,UAAMC,OAAOH,IAAII,KAAJ,CAAU,CAAV,EAAaH,YAAb,CAAb;AACA,UAAMI,KAAKL,IAAII,KAAJ,CAAUH,eAAe,CAAzB,CAAX;;AAEA,UAAMb,QAAQ,kBAAQkB,SAAR,CAAkBH,IAAlB,CAAd;AACA,UAAMd,MAAM,kBAAQiB,SAAR,CAAkBD,EAAlB,EAAsBE,GAAtB,CAA0B,OAA1B,EAAmCnB,MAAMoB,GAAN,CAAU,OAAV,CAAnC,CAAZ;;AAEA,aAAO,IAAIhB,YAAJ,CAAiB;AACtBJ,oBADsB;AAEtBC;AAFsB,OAAjB,CAAP;AAID;;;;EA1BuCF,kB;;kBAArBK,Y","file":"cell-ref-range.js","sourcesContent":["import { Map, Record } from 'immutable';\nimport CellRef from './cell-ref';\nimport coerce from './coerce';\n\nconst CellRefRangeRecord = Record({\n  start: null,\n  end: null\n});\n\nconst coercer = coerce.bind(null, new Map({\n  start: (start) => new CellRef(start),\n  end: (end) => new CellRef(end)\n}));\n\nexport default class CellRefRange extends CellRefRangeRecord {\n  constructor(params) {\n    super(coercer(params));\n  }\n\n  static of(tab, startRow, startCol, endRow, endCol) {\n    return new CellRefRange({\n      start: CellRef.of(tab, startRow, startCol),\n      end: CellRef.of(tab, endRow, endCol)\n    });\n  }\n\n  static fromA1Ref(ref) {\n    // the structure of a ref is <tab><from ref>:<to ref>\n    // <tab> may include a colon so the final colon must be the separator\n    const lastColonIdx = ref.lastIndexOf(':');\n    const from = ref.slice(0, lastColonIdx);\n    const to = ref.slice(lastColonIdx + 1);\n\n    const start = CellRef.fromA1Ref(from);\n    const end = CellRef.fromA1Ref(to).set('tabId', start.get('tabId'));\n\n    return new CellRefRange({\n      start,\n      end\n    });\n  }\n}\n"]}